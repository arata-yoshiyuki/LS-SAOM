#include "constant.h"

const int n_proc = 256;
// const int n_proc = 64;//for gof_flag == 1, n_proc means n_node times processes, i.e., n_simulation
// const int net_size = 22809;//AB
// const int net_size = 22412;//BC
// const int net_size = 22208;//CD
// const int net_size = 21694;//AD
// const int net_size = 83386;//AB
const int net_size = 80685;//BC
// const int net_size = 83812;//CD
// const int net_size = 78730;//AD
const int n_item = 9;
const int pp = 16;

const int n_sub = 20;
const int n_phase_1 = 64;
const int n_phase_2 = 512;
const int n_phase_3 = 2048;
const double eps = 0.20;
const double a_gain = 0.15;

const int kj_ind = 1;
const int log_age = 2;
const int log_sale = 3;
const int d_lab_pro= 4;
const int g_rate = 5;
const int pf_rate = 6;
const int loc_X = 7;
const int loc_Y = 8;

// const string f_name_kj = "KJ_AB_10.txt";
const string f_name_kj = "KJ_BC_12.txt";
// const string f_name_kj = "KJ_CD_14.txt";

// const string f_name_sk_1 = "SK_AB_10.txt";
const string f_name_sk_1 = "SK_BC_12.txt";
// const string f_name_sk_1 = "SK_CD_14.txt";

// const string f_name_sk_2 = "SK_AB_12.txt";
const string f_name_sk_2 = "SK_BC_14.txt";
// const string f_name_sk_2 = "SK_CD_16.txt";

// for gof_2_flag == true
// const string f_name_kj = "KJ_AD_10.txt";
// const string f_name_sk_1 = "SK_AD_10.txt";
// const string f_name_sk_2 = "SK_AD_16.txt";

vector<string> theta_name{
  "rate_p", "rate_outdeg_p", "rate_age_p", "outde_p", "ego_sale_p",
  "alt_lab_pro_p", "alt_grow_p", "alt_pf_p", "alt_sale_p", "inPop_p",
  "sim_size_p", "sim_tech_p", "geo_dis_p", "recipro_p", "two_dis_t1_p",
  "two_dis_t3_p"
};

// vector<double> pre_theta{0.0978895, 1.07427, -0.166254, -3.00622, -0.0256975, -0.0167599, 0.0452167, 0.409613, 0.0180126, 0.455347, 0.106934, 0.0789673, -0.114315, 1.67084, 1.13444, 0.596966};//manu A
// vector<double> pre_theta{0.212864, 1.05016, -0.161687, -2.96146, -0.00752179, -0.0993999, 0.328599, 0.999187, 0.0598921, 0.41324, 0.0586529, 0.0921805, -0.115213, 1.5761, 1.22117, 0.634928};//manu B
// vector<double> pre_theta{0.167919, 1.00033, -0.0832856, -3.04246, -0.0214416, -0.12898, 0.33201, -0.556041, 0.042315, 0.445063, 0.082327, 0.134644, -0.103078, 1.29894, 1.11806, 0.554173};//manu C
// vector<double> pre_theta{0.114049, 1.06839, -0.182106, -3.60031, 0.0236218, -0.145471, 0.464395, -0.508013, 0.0294074, 0.460007, 0.115074, 0.17003, -0.147393, 1.51686, 1.4677, 0.55391};//all A
vector<double> pre_theta{0.219047, 1.07453, -0.186606, -3.58666, 0.0089314, -0.110993, 0.343357, 0.43409, 0.029006, 0.412609, 0.10043, 0.192822, -0.141831, 1.38554, 1.62051, 0.688369};//all B
// vector<double> pre_theta{0.177029, 1.0495, -0.184865, -3.66734, 0.0139231, -0.123369, 0.316787, 0.928713, 0.0133009, 0.4409, 0.105772, 0.207367, -0.1539, 1.42244, 1.54053, 0.570106};//all C

//for gof_2_flag == true
// vector<double> sim_theta_A{0.114003, 1.06853, -0.182181, -3.59973, 0.0237089, -0.145315, 0.463973, -0.508453, 0.029519, 0.459701, 0.114993, 0.170928, -0.147226, 1.51545, 1.46762, 0.553581};//all A
// vector<double> sim_theta_B{0.219159, 1.07423, -0.186831, -3.58695, 0.00878768, -0.111116, 0.343208, 0.435271, 0.0290034, 0.412321, 0.100508, 0.192253, -0.141547, 1.38452, 1.62127, 0.688672};//all B
// vector<double> sim_theta_C{0.177053, 1.04938, -0.184912, -3.66728, 0.0138394, -0.12318, 0.316503, 0.925555, 0.0133277, 0.440754, 0.105777, 0.207114, -0.153831, 1.4234, 1.5409, 0.57001};//all C

//null
vector<double> sim_theta_A{0.114003, 1.06853, -0.182181, -2.83505, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};//all A
vector<double> sim_theta_B{0.219159, 1.07423, -0.186831, -2.89448, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};//all B
vector<double> sim_theta_C{0.177053, 1.04938, -0.184912, -2.92256, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};//all C

const int sim_flag = 0;
const int ph_1_flag = 0;
const int ph_2_flag = 0;
const int ph_3_flag = 1;
const int gof_flag = 0;
const int gof_2_flag = 0;


// D_hat_temp for A

const mat pre_D_hat_temp = {
  {716892, 388379, 17784.4, 6147.19, 12459.3, 1131.95, -93.7109, 354.219, 5988.4, 17551.8, 18415.6, 534.219, 21742.9, -7.03125, 1622.89, 752.812},
  {2.17985e+06, 1.6102e+06, 84380.2, 19878.9, 65264.6, 3195.08, -81.141, 1077.85, 17066.6, 55331.7, 75325.2, 1658.59, 65648.1, 8.35695, 5460.5, 2700.05},
  {118265, 118103, 38532.3, 645.001, 3688.03, 19.1487, 50.4049, 29.7873, 564.24, 1998.95, 3332.04, -37.7803, 1967.81, 8.51337, 377.869, 150.808},
  {162903, 76983.1, 2756.21, 60147.7, 92262.2, 8524.22, -1652.77, 822.969, 51851, 155207, 149176, 3545.31, 162570, 1802.27, 9051.64, 2528.28},
  {230949, 237374, 8946.97, 101281, 429177, 4029.99, -2422.81, 1318.42, 49328.2, 241717, 389284, 1532.77, 254122, 4035.75, 21210.7, 7400.02},
  {8266.97, 3047.22, 975.136, 6921.49, 1092.08, 46801.6, 718.609, 328.826, 63161.7, 44788, 28498.6, 690.345, 11220.5, 588.491, 3677.47, 1463.56},
  {3247.64, 2744.42, 221.029, -1647.61, -2585.54, 662.264, 3240.78, 154.589, -891.635, -4984.22, -4142.82, -89.5248, -4217.92, 16.9323, -284.337, -78.4677},
  {1351.72, 723.886, 34.7683, 758.391, 1184.83, 278.585, 87.2374, 105.457, 1051.22, 2131.72, 1945.03, 44.2806, 2071.81, 30.0459, 123.015, 29.0058},
  {147204, 75025.2, 5604.42, 49857.5, 34632.5, 62465.8, -904.611, 1389.97, 284254, 258253, 165469, 3325.34, 119927, 3084.01, 18114.5, 6988.87},
  {391461, 188606, 8032.31, 160240, 217337, 49738, -5090.05, 2561.59, 272105, 529253, 428372, 9167.71, 422466, 5556.47, 32866.9, 9743.65},
  {422813, 266644, 10158.2, 158063, 380682, 33330.9, -4206.22, 2652.24, 183793, 440092, 634146, 6637.73, 422390, 5455.29, 30371.3, 8604.19},
  {15224.5, 4048.55, 55.4688, 3729.92, 1806.76, 678.398, -142.383, 13.9062, 3134.41, 8892.81, 6529.8, 3566.45, 10229.5, 156.016, 536.836, 198.672},
  {397725, 112946, 4173.43, 148775, 218669, 21277, -4033.6, 1512.6, 141674, 401842, 389797, 9617.81, 1.05098e+06, 3974.68, 19314.4, 4738.04},
  {-3916.8, -333.32, -20.1953, 1783.98, 3085.94, 520.781, -60.8984, -14.6484, 2452.15, 4774.18, 4530.98, 182.031, 3788.05, 1586.21, 402.695, 384.062},
  {98848.4, 63387, 3411.21, 8517.07, 18732.5, 3478.28, -284.062, 187.617, 17204, 31232.9, 27068.4, 560.82, 19812.8, 377.461, 9160.47, 1278.12},
  {36249.3, 25588.5, 1584.38, 2461.41, 6273.75, 1257.81, -120.586, 36.2109, 6757.89, 9432.27, 7234.8, 253.516, 5167.23, 451.836, 1203.95, 3199.06}
};


// D_hat_temp for B
/*
const mat pre_D_hat_temp = {
  {659748, 647519, 30406.1, 20425.7, 44168.9, 3384.88, 882.5, 126.133, 20972.6, 60851.9, 63626.7, 1074.84, 72461.2, 161.836, 4164.88, 1313.91},
  {1.98646e+06, 2.59041e+06, 142215, 66986.4, 229923, 9663.59, 3065.23, 382.829, 61841.7, 194924, 261019, 2253.76, 221785, 1581.43, 15826.6, 5278.55},
  {108124, 188989, 66747.4, 2292.63, 13129.6, 198.097, 218.666, 122.214, 2259.01, 7234.41, 12042.6, -101.413, 6853.4, 174.022, 950.581, 412.033},
  {144725, 131083, 4518.71, 114578, 190452, 19117.9, 5746.64, 1580.9, 106764, 308702, 300437, 7369.14, 320571, 4070.9, 18332.1, 6017.73},
  {172489, 351446, 12091.8, 193302, 883657, 14348.7, 10145.5, 3231.63, 111476, 488013, 798274, 5306.66, 497507, 9437.37, 43597.8, 17802.8},
  {13095, 15588.6, 2240.77, 15250.1, 5238.23, 90242.9, 2576.2, 637.655, 127206, 93646.2, 59787.9, 1109.57, 25414, 1533.15, 7267.9, 3098.75},
  {14358.2, 13678.6, 659.088, 5696.59, 9566.68, 2373.39, 3976.05, 214.951, 5557.03, 15369.6, 15408.4, 319.11, 14939.7, 220.822, 1071.4, 264.771},
  {2049.85, 2216.62, 82.5129, 1809.09, 3149.75, 449.248, 208.694, 171.938, 2255.53, 5215.77, 4732.23, 98.0077, 4930.13, 74.4962, 325.265, 96.8753},
  {114317, 134239, 10070.3, 99018.1, 80354.3, 123448, 6496.13, 2622.13, 567953, 520530, 333597, 6687.47, 242270, 6565.37, 36667.8, 15039.1},
  {328362, 320994, 13261.4, 306930, 453962, 102228, 16166.9, 4839.31, 545519, 1.04914e+06, 859088, 19269.8, 831403, 12373.9, 66663.1, 22368.4},
  {331236, 402272, 15050.2, 303586, 790555, 74174.6, 16561.3, 4673.94, 384741, 884037, 1.28427e+06, 14678.6, 835891, 12884, 62067.8, 21052.1},
  {14337.2, 7755.78, 230.742, 7178.75, 3686.95, 1412.38, 214.727, 38.8672, 6384.77, 17710.8, 13110.1, 6717.54, 20236.8, 484.844, 1137.54, 519.414},
  {357287, 209791, 8358.79, 280530, 435643, 46093.4, 13539.2, 2917.24, 286896, 787807, 769594, 19690.1, 2.05344e+06, 8866.79, 39267.9, 11883.2},
  {-5803.91, -2993.24, -151.875, 3689.02, 6541.09, 1171.52, 219.648, 40.3516, 5083.01, 9775.62, 9436.95, 359.297, 7808.59, 3023.48, 893.164, 869.922},
  {88439.6, 96438.9, 5503.28, 17882.5, 41337.6, 6981.88, 1013.79, 243.945, 35118.1, 66027.9, 59116, 1139.38, 43490.8, 989.688, 16894.7, 2462.11},
  {33869, 42544.9, 2671.8, 5554.3, 14825.2, 2669.88, 241.836, 99.1016, 14196.3, 20700.7, 16926.1, 478.359, 12279.6, 810.859, 2431.21, 5875.43}
};
*/

// D_hat_temp for C
/*
const mat pre_D_hat_temp = {
  {667114, 531975, 24742.3, 12140.8, 23683.9, 1838.87, 740.664, 139.023, 12108.4, 35526.2, 36580.6, 1079.06, 42987.9, -89.1797, 2510.82, 943.203},
  {2.00152e+06, 2.12618e+06, 116611, 38192.1, 122618, 4895.51, 1946.77, 424.149, 33801, 109623, 145195, 2500.11, 127024, 277.63, 8643.62, 3358.12},
  {111172, 160271, 47868.6, 1433.15, 8634.35, 359.564, 198.463, 131.315, 1269.63, 4480.75, 7819.22, -7.08435, 4586.98, 154.133, 694.821, 399.261},
  {119004, 78121.1, 2035.27, 91131.2, 141180, 14137.9, 4614.18, 1980.35, 82922.9, 243836, 232263, 5998.2, 251903, 2796.05, 13606.1, 3857.34},
  {124557, 194409, 7576.12, 146868, 655132, 7541.22, 6615.18, 3680.14, 75908.7, 365660, 591137, 3252.87, 374772, 6300.3, 30464.8, 10952.1},
  {-353.475, 1084.79, 1023.21, 11946.1, 2237.29, 70537, 2600.55, 404.62, 100155, 71678.7, 48425.2, 1009.99, 21547.3, 808.116, 5178.81, 1984.7},
  {10922.7, 7593.88, 277.042, 4870.96, 6598.7, 2398.94, 2617.75, 151.152, 6546.04, 13196.8, 12537.1, 329.119, 14423.5, 117.211, 702.263, 180.138},
  {2178.17, 1792.24, 48.1785, 2064.88, 3255.35, 446.372, 167.445, 178.302, 2868.62, 6065.7, 5437.57, 123.888, 5555.82, 74.6412, 348.263, 117.207},
  {71995.8, 64130.2, 5123.15, 78835.6, 54760.6, 97630.5, 6424.46, 2267.47, 446873, 405184, 270427, 5077.65, 198810, 4160.26, 26506.8, 9816.74},
  {253982, 174838, 5456.63, 246825, 338537, 78445, 13082.6, 5823.49, 426562, 831011, 677682, 15383.5, 667412, 8116, 49714, 14572.4},
  {266419, 234689, 7689.28, 238532, 581987, 57195.3, 12233.7, 5098.47, 302823, 691409, 983289, 10885.8, 651286, 8206.98, 45332, 12837.4},
  {13649.9, 5707.7, 40.3906, 5976.17, 2855.2, 1079.65, 377.5, 153.633, 5169.73, 14407.9, 10566.2, 5656.88, 16420.7, 377.344, 858.242, 398.086},
  {276736, 88858.5, 2764.38, 222834, 327440, 36613.1, 12391.5, 4934.57, 228608, 625871, 600489, 15501, 1.59763e+06, 6691.61, 30218.2, 8312.96},
  {-6375.82, -3215.51, -90.2344, 2886.13, 4789.22, 946.758, 150.898, 90.6641, 3991.76, 7700.27, 7275.74, 353.125, 6245.35, 2391.6, 631.016, 640.82},
  {84703.2, 76682.5, 4244.22, 13308.5, 29091.9, 5257.15, 656.25, 339.648, 26808.1, 49357.5, 43473.2, 856.289, 32033.2, 585.117, 12859.1, 1660.94},
  {29524.5, 29576.7, 1799.38, 3789.53, 9440.98, 1879.57, 182.539, 134.492, 10044.2, 14256.8, 11435.7, 351.641, 8261.68, 584.922, 1644.18, 4230.82}
};
*/
